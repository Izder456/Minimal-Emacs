<p>Hetzner introduced its <strong>Ampere Altra</strong> powered <a rel="noopener" target="_blank" href="https://www.hetzner.com/press-release/arm64-cloud">arm64-based cloud servers</a>
earlier this year, making it possible to easily run OpenBSD/arm64 on their
platform.</p>
<p>The only caveat for now is that the <a rel="noopener" target="_blank" href="https://www.undeadly.org/cgi?action=article;sid=20230421124221">viogpu(4) driver</a> is required, which
was committed by jcs@ in April 2023 and thus only available in snapshots.
It will first appear in OpenBSD 7.4.</p>
<p>Here is the relevant excerpt from the manual page:</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span>DESCRIPTION
</span><span>     The viogpu driver provides support for the virtio(4) GPU interface
</span><span>     provided by QEMU and other virtual machines to create a wscons(4)
</span><span>     console.
</span></code></pre>
<p>To install the system, we need to provision a Linux instance to fetch
the installation media and write it to the root disk.</p>
<pre data-lang="sh" style="background-color:#272822;color:#f8f8f2;" class="language-sh "><code class="language-sh" data-lang="sh"><span>wget https://cdn.openbsd.org/pub/OpenBSD/snapshots/arm64/miniroot74.img
</span><span>dd if=miniroot74.img of=/dev/sda bs=4M
</span></code></pre>
<p>The installer will start after reboot, allowing us to perform an interactive
installation using the console.</p>
<p>I'm using the CAX11 instance providing 2 vCPUs and 4 GB of RAM.</p>
<p>Here is the result of a quick <strong>md5 -t</strong> benchmark:</p>
<pre data-lang="sh" style="background-color:#272822;color:#f8f8f2;" class="language-sh "><code class="language-sh" data-lang="sh"><span>MD5 time trial.  Processing 10000 10000-byte blocks...
</span><span>Digest = 52e5f9c9e6f656f3e1800dfa5579d089
</span><span>Time   = 0.220000 seconds
</span><span>Speed  = 454545454.545455 bytes/second
</span></code></pre>
<p>Here is the result of the <strong>sha1 -t</strong> benchmark:</p>
<pre data-lang="sh" style="background-color:#272822;color:#f8f8f2;" class="language-sh "><code class="language-sh" data-lang="sh"><span>SHA1 time trial.  Processing 10000 10000-byte blocks...
</span><span>Digest = 74a57b897cc581defa5b3a359fa762a1b83a60e8
</span><span>Time   = 0.230000 seconds
</span><span>Speed  = 434782608.695652 bytes/second
</span></code></pre>
<p>For the record, LibreSSL speed benchmark results are available <a href="/files/openbsd/openssl-speed-hetzner-cloud.txt">here</a>.</p>
<p>System message buffer (dmesg output):</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span>OpenBSD 7.4-beta (GENERIC.MP) #2251: Tue Sep 19 12:41:16 MDT 2023
</span><span>    deraadt@arm64.openbsd.org:/usr/src/sys/arch/arm64/compile/GENERIC.MP
</span><span>real mem  = 4185800704 (3991MB)
</span><span>avail mem = 3976454144 (3792MB)
</span><span>random: good seed from bootblocks
</span><span>mainbus0 at root: ACPI
</span><span>psci0 at mainbus0: PSCI 1.0, SMCCC 1.1
</span><span>efi0 at mainbus0: UEFI 2.7
</span><span>efi0: EDK II rev 0x10000
</span><span>smbios0 at efi0: SMBIOS 3.0.0
</span><span>smbios0: vendor Hetzner version &quot;20171111&quot; date 11/11/2017
</span><span>smbios0: Hetzner vServer
</span><span>cpu0 at mainbus0 mpidr 0: ARM Neoverse N1 r3p1
</span><span>cpu0: 64KB 64b/line 4-way L1 PIPT I-cache, 64KB 64b/line 4-way L1 D-cache
</span><span>cpu0: 1024KB 64b/line 8-way L2 cache
</span><span>cpu0: DP,RDM,Atomic,CRC32,SHA2,SHA1,AES+PMULL,LRCPC,DPB,ASID16,PAN+ATS1E1,LO,HPDS,VH,HAFDBS,CSV3,CSV2,SBSS+MSR
</span><span>cpu1 at mainbus0 mpidr 1: ARM Neoverse N1 r3p1
</span><span>cpu1: 64KB 64b/line 4-way L1 PIPT I-cache, 64KB 64b/line 4-way L1 D-cache
</span><span>cpu1: 1024KB 64b/line 8-way L2 cache
</span><span>cpu1: DP,RDM,Atomic,CRC32,SHA2,SHA1,AES+PMULL,LRCPC,DPB,ASID16,PAN+ATS1E1,LO,HPDS,VH,HAFDBS,CSV3,CSV2,SBSS+MSR
</span><span>apm0 at mainbus0
</span><span>agintc0 at mainbus0 shift 4:4 nirq 288 nredist 2 ipi: 0, 1, 2: &quot;interrupt-controller&quot;
</span><span>agintcmsi0 at agintc0
</span><span>agtimer0 at mainbus0: 25000 kHz
</span><span>acpi0 at mainbus0: ACPI 5.1
</span><span>acpi0: sleep states
</span><span>acpi0: tables DSDT FACP APIC PPTT GTDT MCFG SPCR DBG2 IORT BGRT
</span><span>acpi0: wakeup devices
</span><span>acpimcfg0 at acpi0
</span><span>acpimcfg0: addr 0x4010000000, bus 0-255
</span><span>acpiiort0 at acpi0
</span><span>&quot;ACPI0007&quot; at acpi0 not configured
</span><span>&quot;ACPI0007&quot; at acpi0 not configured
</span><span>pluart0 at acpi0 COM0 addr 0x9000000/0x1000 irq 33
</span><span>pluart0: console
</span><span>&quot;QEMU0002&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>&quot;LNRO0005&quot; at acpi0 not configured
</span><span>acpipci0 at acpi0 PCI0
</span><span>pci0 at acpipci0
</span><span>0:4:0: io address conflict 0x8200/0x8
</span><span>&quot;Red Hat Host&quot; rev 0x00 at pci0 dev 0 function 0 not configured
</span><span>virtio0 at pci0 dev 1 function 0 &quot;Qumranet Virtio 1.x GPU&quot; rev 0x01
</span><span>viogpu0 at virtio0: 1024x768, 32bpp
</span><span>wsdisplay0 at viogpu0 mux 1: console (std, vt100 emulation)
</span><span>wsdisplay0: screen 1-5 added (std, vt100 emulation)
</span><span>virtio0: msix per-VQ
</span><span>ppb0 at pci0 dev 2 function 0 vendor &quot;Red Hat&quot;, unknown product 0x000c rev 0x00: irq 37
</span><span>pci1 at ppb0 bus 1
</span><span>1:0:0: rom address conflict 0xfff80000/0x80000
</span><span>virtio1 at pci1 dev 0 function 0 &quot;Qumranet Virtio 1.x Network&quot; rev 0x01
</span><span>vio0 at virtio1: address 96:00:02:8c:5b:eb
</span><span>virtio1: msix per-VQ
</span><span>ppb1 at pci0 dev 2 function 1 vendor &quot;Red Hat&quot;, unknown product 0x000c rev 0x00: irq 37
</span><span>pci2 at ppb1 bus 2
</span><span>xhci0 at pci2 dev 0 function 0 vendor &quot;Red Hat&quot;, unknown product 0x000d rev 0x01: msix, xHCI 0.0
</span><span>usb0 at xhci0: USB revision 3.0
</span><span>uhub0 at usb0 configuration 1 interface 0 &quot;Red Hat xHCI root hub&quot; rev 3.00/1.00 addr 1
</span><span>ppb2 at pci0 dev 2 function 2 vendor &quot;Red Hat&quot;, unknown product 0x000c rev 0x00: irq 37
</span><span>pci3 at ppb2 bus 3
</span><span>virtio2 at pci3 dev 0 function 0 &quot;Qumranet Virtio 1.x Console&quot; rev 0x01
</span><span>virtio2: no matching child driver; not configured
</span><span>ppb3 at pci0 dev 2 function 3 vendor &quot;Red Hat&quot;, unknown product 0x000c rev 0x00: irq 37
</span><span>pci4 at ppb3 bus 4
</span><span>virtio3 at pci4 dev 0 function 0 vendor &quot;Qumranet&quot;, unknown product 0x1045 rev 0x01
</span><span>viomb0 at virtio3
</span><span>virtio3: irq 37
</span><span>ppb4 at pci0 dev 2 function 4 vendor &quot;Red Hat&quot;, unknown product 0x000c rev 0x00: irq 37
</span><span>pci5 at ppb4 bus 5
</span><span>virtio4 at pci5 dev 0 function 0 &quot;Qumranet Virtio 1.x RNG&quot; rev 0x01
</span><span>viornd0 at virtio4
</span><span>virtio4: irq 37
</span><span>ppb5 at pci0 dev 2 function 5 vendor &quot;Red Hat&quot;, unknown product 0x000c rev 0x00: irq 37
</span><span>pci6 at ppb5 bus 6
</span><span>virtio5 at pci6 dev 0 function 0 &quot;Qumranet Virtio 1.x SCSI&quot; rev 0x01
</span><span>vioscsi0 at virtio5: qsize 256
</span><span>scsibus0 at vioscsi0: 255 targets
</span><span>cd0 at scsibus0 targ 0 lun 0: &lt;QEMU, QEMU CD-ROM, 2.5+&gt; removable
</span><span>sd0 at scsibus0 targ 0 lun 1: &lt;QEMU, QEMU HARDDISK, 2.5+&gt;
</span><span>sd0: 39064MB, 512 bytes/sector, 80003072 sectors, thin
</span><span>virtio5: msix per-VQ
</span><span>ppb6 at pci0 dev 2 function 6 vendor &quot;Red Hat&quot;, unknown product 0x000c rev 0x00: irq 37
</span><span>pci7 at ppb6 bus 7
</span><span>ppb7 at pci0 dev 2 function 7 vendor &quot;Red Hat&quot;, unknown product 0x000c rev 0x00: irq 37
</span><span>pci8 at ppb7 bus 8
</span><span>ppb8 at pci0 dev 3 function 0 vendor &quot;Red Hat&quot;, unknown product 0x000c rev 0x00: irq 38
</span><span>pci9 at ppb8 bus 9
</span><span>&quot;Red Hat Qemu Serial&quot; rev 0x01 at pci0 dev 4 function 0 not configured
</span><span>acpige0 at acpi0 irq 41
</span><span>acpibtn0 at acpi0: PWRB
</span><span>uhidev0 at uhub0 port 5 configuration 1 interface 0 &quot;QEMU QEMU USB Tablet&quot; rev 2.00/0.00 addr 2
</span><span>uhidev0: iclass 3/0
</span><span>ums0 at uhidev0: 3 buttons, Z dir
</span><span>wsmouse0 at ums0 mux 0
</span><span>uhidev1 at uhub0 port 6 configuration 1 interface 0 &quot;QEMU QEMU USB Keyboard&quot; rev 2.00/0.00 addr 3
</span><span>uhidev1: iclass 3/1
</span><span>ukbd0 at uhidev1: 8 variable keys, 6 key codes
</span><span>wskbd0 at ukbd0 mux 1
</span><span>wskbd0: connecting to wsdisplay0
</span><span>vscsi0 at root
</span><span>scsibus1 at vscsi0: 256 targets
</span><span>softraid0 at root
</span><span>scsibus2 at softraid0: 256 targets
</span><span>root on sd0a (8d3ced025e1dcf8f.a) swap on sd0b dump on sd0b
</span></code></pre>
